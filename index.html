<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>운빨배틀타로 - 세컨머니 AI</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fdfaf5;
      color: #333;
      text-align: center;
      padding: 2rem;
    }
    .card { font-size: 1.8rem; margin: 1rem; }
    #resultArea, #summary { margin-top: 1.5rem; }
    button {
      font-size: 1rem; padding: 0.6rem 1.2rem;
      margin: 0.5rem; cursor: pointer;
    }
    a {
      text-decoration: none;
      font-weight: bold;
      color: #0077cc;
    }
    @media (max-width: 600px) {
      body { font-size: 0.9rem; }
      .card { font-size: 1.4rem; }
      button {
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
      }
      h1 { font-size: 1.5rem; }
      p, a { font-size: 0.9rem; }
    }
  </style>
</head>
<body>
  <h1>🔮 운빨배틀타로</h1>
  <p>오늘의 운을 세 장의 타로카드로 확인해보세요!</p>
  <p>
    📌 더 많은 돈 되는 실험은  
    <a href="https://blog.naver.com/greenfrog232" target="_blank">
      세컨머니 실험실 블로그V1.8
    </a>
    에서 확인해보세요!
  </p>

  <div id="buttonArea">
    <button onclick="chooseCard('A')">A</button>
    <button onclick="chooseCard('B')">B</button>
    <button onclick="chooseCard('C')">C</button>
  </div>
  <button onclick="location.reload()">다시하기</button>
  <button onclick="shareResult()">공유하기</button>

  <div id="resultArea"></div>
  <div id="summary"></div>

<script>
const tarotDeck = {
  "빡통": { up: { score: 7, emoji: "🤡" }, down: { score: 3, emoji: "🤡" } },
  "마법사": { up: { score: 8, emoji: "🧙" }, down: { score: 4, emoji: "🧙" } },
  "여사제": { up: { score: 8, emoji: "👸" }, down: { score: 5, emoji: "👸" } },
  "여황제": { up: { score: 9, emoji: "👑" }, down: { score: 5, emoji: "👑" } },
  "황제": { up: { score: 9, emoji: "🦁" }, down: { score: 6, emoji: "🦁" } },
  "교황": { up: { score: 8, emoji: "🙏" }, down: { score: 5, emoji: "🙏" } },
  "연인": { up: { score: 10, emoji: "💘" }, down: { score: 4, emoji: "💘" } },
  "전차": { up: { score: 9, emoji: "🏎️" }, down: { score: 4, emoji: "🏎️" } },
  "힘,기백": { up: { score: 8, emoji: "💪" }, down: { score: 4, emoji: "💪" } },
  "은둔자,찐따": { up: { score: 7, emoji: "🧘" }, down: { score: 3, emoji: "🧘" } },
  "운명의 수레바퀴": { up: { score: 10, emoji: "🎡" }, down: { score: 5, emoji: "🎡" } },
  "정의": { up: { score: 8, emoji: "⚖️" }, down: { score: 5, emoji: "⚖️" } },
  "매달린사람": { up: { score: 6, emoji: "🙃" }, down: { score: 2, emoji: "🙃" } },
  "죽음": { up: { score: 9, emoji: "💀" }, down: { score: 3, emoji: "💀" } },
  "절제": { up: { score: 8, emoji: "🌈" }, down: { score: 4, emoji: "🌈" } },
  "악마": { up: { score: 6, emoji: "😈" }, down: { score: 3, emoji: "😈" } },
  "The Tower": { up: { score: 7, emoji: "🌩️" }, down: { score: 2, emoji: "🌩️" } },
  "The Star": { up: { score: 10, emoji: "⭐" }, down: { score: 6, emoji: "⭐" } },
  "The Moon": { up: { score: 7, emoji: "🌙" }, down: { score: 4, emoji: "🌙" } },
  "The Sun": { up: { score: 10, emoji: "☀️" }, down: { score: 6, emoji: "☀️" } },
  "심판": { up: { score: 9, emoji: "📣" }, down: { score: 5, emoji: "📣" } },
  "The World": { up: { score: 10, emoji: "🌍" }, down: { score: 6, emoji: "🌍" } }
};

const rareCombosSimple = {
  ["The Moon|The Star|The Sun".split("|").sort().join("|")]: "밤과 낮의 경계에서 기회가 피어납니다 🌟🌙☀️ (레어)",
  ["The Moon|운명의 수레바퀴|여사제".split("|").sort().join("|")]: "직관과 흐름을 믿으세요. 감춰진 기회가 보일지도 🌙🎡👁️ (레어)",
  ["The Star|교황|절제".split("|").sort().join("|")]: "영적인 치유와 조화의 기운이 가득한 하루입니다 🙏🌈✨ (레어)",
  ["The Star|심판|은둔자,찐따".split("|").sort().join("|")]: "쌓은 노력, 드디어 빛을 볼 준비가 되었습니다 ✨🧘📣 (레어)",
  ["The Star|여사제|연인".split("|").sort().join("|")]: "이상과 사랑의 하모니! 설렘 가득한 하루 💘✨👸 (레어)",
  ["The Sun|The World|연인".split("|").sort().join("|")]: "완벽한 사랑과 성공! 오늘은 우주의 축복이 함께합니다 💖🌞🌍 (레어)",
  ["The Sun|전차|정의".split("|").sort().join("|")]: "정의로운 돌진! 오늘은 내가 법이다 🏎️☀️⚖️ (레어)",
  ["The Tower|운명의 수레바퀴|전차".split("|").sort().join("|")]: "멈출 수 없는 변화의 질주! 새판 짜기 시작! 🎡🏎️💀 (레어)",
  ["The Tower|전차|힘,기백".split("|").sort().join("|")]: "강한 추진력도 필요하지만 조심! 속도 조절! 🏎️💥💪 (레어)",
  ["The Tower|빡통|전차".split("|").sort().join("|")]: "아찔한 질주, 정신줄 조심! 오늘은 사고방지데이 🤡🏎️😈 (레어)",
  ["The Tower|악마|죽음".split("|").sort().join("|")]: "심상치 않은 조합입니다. 내면을 단단히 다잡으세요. (레어)",
  ["교황|마법사|황제".split("|").sort().join("|")]: "지혜와 권력이 한 자리에! 리더십이 빛날 날입니다 👑📘🧙 (레어)",
  ["교황|여사제|황제".split("|").sort().join("|")]: "지식, 신념, 권력이 만났습니다. 누가 감히 넘보랴 🙇📘👑 (레어)",
  ["마법사|심판|죽음".split("|").sort().join("|")]: "변화의 마법이 시작됩니다. 운명의 심판을 받아라! 🧙💀📣 (레어)",
  ["매달린사람|빡통|은둔자,찐따".split("|").sort().join("|")]: "혼자만의 세계에 빠질 수 있어요. 조용한 하루를 추천합니다. (레어)",
  ["여사제|연인|절제".split("|").sort().join("|")]: "사랑과 조화의 에너지! 인간관계가 술술 풀릴 거예요 💕🤝🌈 (레어)",
  ["여황제|연인|황제".split("|").sort().join("|")]: "이보다 완벽한 밸런스는 없다! 💑👑 (레어)",
  ["운명의 수레바퀴|심판|정의".split("|").sort().join("|")]: "운명과 정의, 그리고 심판! 변화의 중심에 있습니다 ⚖️🌀📣 (레어)",
  ["은둔자,찐따|The Moon|악마".split("|").sort().join("|")]: "내면의 어둠을 직면하세요. 피하지 말고 마주보는 날 🧘🌙😈 (레어)",
  ["정의|죽음|악마".split("|").sort().join("|")]: "어둠 속에서도 균형을 찾는 자만이 변화를 이끈다 😈💀⚖️ (레어)",
  ["The World|심판|절제".split("|").sort().join("|")]: "완성, 판단, 절제… 인생의 한 챕터가 마무리됩니다 🌍📣🌈 (레어)",
  ["The Star|죽음|은둔자,찐따".split("|").sort().join("|")]: "빛을 보기 위한 고요한 변화, 혼자만의 시간이 필요합니다 🌟💀🧘 (레어)",
  ["여사제|정의|절제".split("|").sort().join("|")]: "이성적 판단이 필요한 순간. 균형 잡힌 결정이 열쇠! ⚖️👸🌈 (레어)",
  ["The Moon|The Tower|운명의 수레바퀴".split("|").sort().join("|")]: "예상 못한 감정의 폭풍! 운명의 장난에 흔들리지 마세요 🌙🌩️🎡 (레어)",
  ["연인|마법사|죽음".split("|").sort().join("|")]: "관계의 끝 혹은 새로운 시작… 마법처럼 급변하는 하루 💘🧙💀 (레어)",
  ["여황제|교황|힘,기백".split("|").sort().join("|")]: "따뜻한 카리스마! 부드러움 속의 강인함이 돋보입니다 👑🙏💪 (레어)",
  ["The World|은둔자,찐따|매달린사람".split("|").sort().join("|")]: "완성을 앞두고 고독 속에 멈춤… 기다림 끝의 희망 🌍🧘🙃 (레어)",
  ["The Tower|정의|The Moon".split("|").sort().join("|")]: "감정과 진실이 충돌합니다. 오늘은 솔직함이 중요해요 🌩️⚖️🌙 (레어)",
  ["전차|연인|은둔자,찐따".split("|").sort().join("|")]: "혼자만의 질주 금지! 타인과의 교감이 필요한 시점 🏎️💘🧘 (레어)",
  ["The Sun|죽음|악마".split("|").sort().join("|")]: "밝은 얼굴 뒤 어둠, 유혹과 이별의 경계 ☀️💀😈 (레어)",
  ["여황제|The Star|힘,기백".split("|").sort().join("|")]: "자신감 넘치는 하루! 이상을 향해 한걸음 전진 💪⭐👑 (레어)",
  ["The Tower|여사제|교황".split("|").sort().join("|")]: "혼돈 속에서 찾는 신념과 지혜… 마음을 단단히 🙏📘🌩️ (레어)",
  ["운명의 수레바퀴|빡통|심판".split("|").sort().join("|")]: "어제의 빡침도 오늘은 기회! 반전의 날이 될 수 있어요 🤡📣🎡 (레어)",
  ["The Star|마법사|전차".split("|").sort().join("|")]: "이상과 기술, 그리고 추진력! 무엇이든 가능해 보이는 하루 ⭐🧙🏎️ (레어)",
  ["정의|악마|전차".split("|").sort().join("|")]: "법과 본능 사이… 어느 쪽도 과하지 않게 조절하세요 🏎️⚖️😈 (레어)",
  ["The Sun|절제|여사제".split("|").sort().join("|")]: "따뜻한 내면의 평화를 찾을 수 있는 날 ☀️👸🌈 (레어)",
  ["심판|황제|힘,기백".split("|").sort().join("|")]: "판단과 권위, 그리고 추진력. 오늘은 책임질 각오로 💪📣🦁 (레어)",
  ["죽음|절제|운명의 수레바퀴".split("|").sort().join("|")]: "운명의 흐름에 몸을 맡기되, 균형 잃지 말 것 🎡💀🌈 (레어)",
  ["은둔자,찐따|악마|The Star".split("|").sort().join("|")]: "내면의 유혹을 넘으면 진짜 꿈이 보입니다 😈🧘⭐ (레어)",
  ["The World|The Sun|The Star".split("|").sort().join("|")]: "완성된 꿈과 찬란한 결과! 우주가 당신 편입니다 🌍☀️⭐ (레어)",
  ["The Star|마법사|정의".split("|").sort().join("|")]: "이상과 논리, 그리고 정의… 오늘은 올바른 방향으로 🌟🧙⚖️ (레어)",
  ["죽음|The Tower|매달린사람".split("|").sort().join("|")]: "고통 속 변화, 멈춤이 전환점이 됩니다 💀🙃🌩️ (레어)",
  ["황제|The Moon|연인".split("|").sort().join("|")]: "리더십과 감정 사이 균형 잡기! 사랑이 흔들릴 수도 💘🦁🌙 (레어)",
  ["교황|절제|힘,기백".split("|").sort().join("|")]: "내면의 신념과 균형이 강한 힘을 만들어냅니다 🙏🌈💪 (레어)",
  ["The World|The Star|여황제".split("|").sort().join("|")]: "완벽한 미래, 풍요와 이상이 조화를 이룹니다 🌍👑⭐ (레어)",
  ["심판|The Tower|연인".split("|").sort().join("|")]: "관계에 큰 결정이 필요할 수 있어요. 무너질지 넘어설지 💘📣🌩️ (레어)",
  ["운명의 수레바퀴|전차|여사제".split("|").sort().join("|")]: "빠른 흐름 속 직관을 믿어야 하는 날 🎡🏎️👸 (레어)",
  ["The Sun|마법사|악마".split("|").sort().join("|")]: "빛과 그림자, 당신 안의 양면이 모두 활약 중 ☀️🧙😈 (레어)",
  ["죽음|The Star|전차".split("|").sort().join("|")]: "변화의 끝에서 다시 달려 나갑니다 ⭐💀🏎️ (레어)",
  ["여황제|심판|은둔자,찐따".split("|").sort().join("|")]: "마음의 판단, 휴식이 필요한 시점입니다 👑📣🧘 (레어)",
  ["매달린사람|연인|The Star".split("|").sort().join("|")]: "사랑에 대한 이상… 하지만 지금은 잠시 기다림 🙃💘⭐ (레어)",
  ["황제|전차|정의".split("|").sort().join("|")]: "지도자와 정의로운 돌진! 팀워크에 책임감을 🦁🏎️⚖️ (레어)",
  ["The Moon|은둔자,찐따|절제".split("|").sort().join("|")]: "내면의 평화를 위한 고요한 사색 🌙🧘🌈 (레어)",
  ["여사제|죽음|전차".split("|").sort().join("|")]: "직관에 따른 행동, 변화를 위한 추진력 🧘💀🏎️ (레어)",
  ["마법사|The World|힘,기백".split("|").sort().join("|")]: "성공을 위한 의지와 기술, 오늘은 만들 수 있어요 🌍🧙💪 (레어)",
  ["교황|매달린사람|심판".split("|").sort().join("|")]: "믿음 속에서 내려진 결정, 오늘은 인생의 전환점 📣🙃🙏 (레어)",
  ["The Tower|악마|은둔자,찐따".split("|").sort().join("|")]: "위험한 고립. 스스로를 믿고 일어서세요 😈🧘🌩️ (레어)",
  ["전차|절제|운명의 수레바퀴".split("|").sort().join("|")]: "빠르게 움직이되, 조율과 흐름을 잊지 마세요 🏎️🌈🎡 (레어)",
  ["정의|연인|The Star".split("|").sort().join("|")]: "사랑 속에서의 정의로운 선택, 빛나는 인연 ⭐⚖️💘 (레어)",
  ["The World|The Moon|죽음".split("|").sort().join("|")]: "감춰진 진실 끝의 완성… 모든 것이 바뀔 운명입니다 🌙💀🌍 (레어)"


};


let bundles = { A: [], B: [], C: [] };
let selectedSet = null;
let revealed = false;

function drawThreeCards() {
  const names = Object.keys(tarotDeck);
  const used = new Set();
  const result = [];

  while (result.length < 3) {
    const name = names[Math.floor(Math.random() * names.length)];
    if (!used.has(name)) {
      used.add(name);
      const orientation = Math.random() > 0.5 ? "up" : "down";
      result.push({ name, orientation });
    }
  }

  return result;
}

function prepareDeck() {
  bundles.A = drawThreeCards();
  bundles.B = drawThreeCards();
  bundles.C = drawThreeCards();
}

function chooseCard(choice) {
  if (revealed) return;
  revealed = true;
  selectedSet = bundles[choice];
  document.querySelectorAll("#buttonArea button").forEach(btn => btn.disabled = true);

  let upCount = 0;
  let downCount = 0;

  const totalScore = selectedSet.reduce((sum, card) => {
    const info = tarotDeck[card.name]?.[card.orientation];
    if (!info) return sum;
    if (card.orientation === "up") upCount++;
    else downCount++;
    return sum + info.score;
  }, 0);

  const currentComboKey = selectedSet.map(c => c.name).sort().join("|");
  let comboMessage = rareCombosSimple[currentComboKey] || "";

  if (!comboMessage) {
    if (upCount === 3) comboMessage = "정방향 3장! 운이 강하게 따라붙습니다 🎯";
    else if (downCount === 3) comboMessage = "모두 역방향... 예상과 다른 흐름이에요 ⚠️";
    else if (upCount === 2) comboMessage = "정방향 2장 😊 운이 트이기 시작했어요!";
    else if (downCount === 2) comboMessage = "역방향 2장. 신중한 하루가 될 수도 있어요!";
    else comboMessage = "";
  }

  let resultHTML = `<h3>🔮 ${choice} 선택 결과</h3>`;
  selectedSet.forEach(card => {
    const info = tarotDeck[card.name]?.[card.orientation];
    if (!info) return;
    const arrow = card.orientation === "up" ? "⬆️" : "⬇️";
    const direction = card.orientation === "up" ? "정방향" : "역방향";
    resultHTML += `
      <div class="card">${info.emoji} ${card.name} ${arrow} (${direction})<br>
      점수: ${info.score}점</div>`;
  });

  if (comboMessage) {
    resultHTML += `<p><strong>${comboMessage}</strong></p>`;
  }

  const ratingText = totalScore === 30 ? "총합: 30점 (만점!)" :
    totalScore <= 10 ? `총합: ${totalScore}점 (운보소 ㅋㅋㅋ)` :
    `총합: ${totalScore}점 (상위 ${Math.round((totalScore / 30) * 100)}%)`;

  resultHTML += `<p><strong>${ratingText}</strong></p>`;
  document.getElementById("resultArea").innerHTML = resultHTML;

  let summaryHTML = `<h3>📊 다른 선택지 점수 요약</h3>`;
  ["A", "B", "C"].forEach(label => {
    if (label === choice) return;
    const score = bundles[label].reduce((sum, c) => {
      const info = tarotDeck[c.name]?.[c.orientation];
      return sum + (info?.score || 0);
    }, 0);
    const percent = Math.round((score / 30) * 100);
    summaryHTML += `<p>🔸 ${label} 카드: ${score}점 (${percent}%)</p>`;
  });

  document.getElementById("summary").innerHTML = summaryHTML;
  document.getElementById("buttonArea").style.display = "none";
}

function shareResult() {
  if (!selectedSet) return alert("카드를 먼저 선택해 주세요!");
  const shareText = selectedSet.map(card => {
    const info = tarotDeck[card.name][card.orientation];
    const arrow = card.orientation === "up" ? "⬆️" : "⬇️";
    return `${info.emoji} ${card.name} ${arrow}`;
  }).join(", ");
  const totalScore = selectedSet.reduce(
    (sum, c) => sum + tarotDeck[c.name][c.orientation].score,
    0
  );
  const fullText = `🔮 운빨배틀타로 결과!\n[${shareText}]\n총점: ${totalScore}점\n👉 https://jeffersonwattson.github.io/tarot-ai/`;

  if (navigator.share) {
    navigator.share({ title: "운빨배틀타로", text: fullText, url: window.location.href });
  } else {
    navigator.clipboard.writeText(fullText).then(() => alert("결과 복사됨 📋"));
  }
}

window.onload = prepareDeck;
</script>
</body>
</html>
