<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìš´ë¹¨ë°°í‹€íƒ€ë¡œ - ì„¸ì»¨ë¨¸ë‹ˆ AI</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fdfaf5;
      color: #333;
      text-align: center;
      padding: 2rem;
    }
    .card { font-size: 1.8rem; margin: 1rem; }
    #resultArea, #summary { margin-top: 1.5rem; }
    button {
      font-size: 1rem; padding: 0.6rem 1.2rem;
      margin: 0.5rem; cursor: pointer;
    }
    a {
      text-decoration: none;
      font-weight: bold;
      color: #0077cc;
    }
    @media (max-width: 600px) {
      body { font-size: 0.9rem; }
      .card { font-size: 1.4rem; }
      button {
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
      }
      h1 { font-size: 1.5rem; }
      p, a { font-size: 0.9rem; }
    }
  </style>
</head>
<body>
  <h1>ğŸ”® ìš´ë¹¨ë°°í‹€íƒ€ë¡œ</h1>
  <p>ì˜¤ëŠ˜ì˜ ìš´ì„ ì„¸ ì¥ì˜ íƒ€ë¡œì¹´ë“œë¡œ í™•ì¸í•´ë³´ì„¸ìš”!</p>
  <p>
    ğŸ“Œ ë” ë§ì€ ëˆ ë˜ëŠ” ì‹¤í—˜ì€  
    <a href="https://blog.naver.com/greenfrog232" target="_blank">
      ì„¸ì»¨ë¨¸ë‹ˆ ì‹¤í—˜ì‹¤ ë¸”ë¡œê·¸V1.5
    </a>
    ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš”!
  </p>

  <div id="buttonArea">
    <button onclick="chooseCard('A')">A</button>
    <button onclick="chooseCard('B')">B</button>
    <button onclick="chooseCard('C')">C</button>
  </div>
  <button onclick="location.reload()">ë‹¤ì‹œí•˜ê¸°</button>
  <button onclick="shareResult()">ê³µìœ í•˜ê¸°</button>

  <div id="resultArea"></div>
  <div id="summary"></div>

<script>
const tarotDeck = {
  "ë¹¡í†µ": { up: { score: 7, emoji: "ğŸ¤¡" }, down: { score: 3, emoji: "ğŸ¤¡" } },
  "ë§ˆë²•ì‚¬": { up: { score: 8, emoji: "ğŸ§™" }, down: { score: 4, emoji: "ğŸ§™" } },
  "ì—¬ì‚¬ì œ": { up: { score: 8, emoji: "ğŸ‘¸" }, down: { score: 5, emoji: "ğŸ‘¸" } },
  "ì—¬í™©ì œ": { up: { score: 9, emoji: "ğŸ‘‘" }, down: { score: 5, emoji: "ğŸ‘‘" } },
  "í™©ì œ": { up: { score: 9, emoji: "ğŸ¦" }, down: { score: 6, emoji: "ğŸ¦" } },
  "êµí™©": { up: { score: 8, emoji: "ğŸ™" }, down: { score: 5, emoji: "ğŸ™" } },
  "ì—°ì¸": { up: { score: 10, emoji: "ğŸ’˜" }, down: { score: 4, emoji: "ğŸ’˜" } },
  "ì „ì°¨": { up: { score: 9, emoji: "ğŸï¸" }, down: { score: 4, emoji: "ğŸï¸" } },
  "í˜,ê¸°ë°±": { up: { score: 8, emoji: "ğŸ’ª" }, down: { score: 4, emoji: "ğŸ’ª" } },
  "ì€ë‘”ì,ì°ë”°": { up: { score: 7, emoji: "ğŸ§˜" }, down: { score: 3, emoji: "ğŸ§˜" } },
  "ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´": { up: { score: 10, emoji: "ğŸ¡" }, down: { score: 5, emoji: "ğŸ¡" } },
  "ì •ì˜": { up: { score: 8, emoji: "âš–ï¸" }, down: { score: 5, emoji: "âš–ï¸" } },
  "ë§¤ë‹¬ë¦°ì‚¬ëŒ": { up: { score: 6, emoji: "ğŸ™ƒ" }, down: { score: 2, emoji: "ğŸ™ƒ" } },
  "ì£½ìŒ": { up: { score: 9, emoji: "ğŸ’€" }, down: { score: 3, emoji: "ğŸ’€" } },
  "ì ˆì œ": { up: { score: 8, emoji: "ğŸŒˆ" }, down: { score: 4, emoji: "ğŸŒˆ" } },
  "ì•…ë§ˆ": { up: { score: 6, emoji: "ğŸ˜ˆ" }, down: { score: 3, emoji: "ğŸ˜ˆ" } },
  "The Tower": { up: { score: 7, emoji: "ğŸŒ©ï¸" }, down: { score: 2, emoji: "ğŸŒ©ï¸" } },
  "The Star": { up: { score: 10, emoji: "â­" }, down: { score: 6, emoji: "â­" } },
  "The Moon": { up: { score: 7, emoji: "ğŸŒ™" }, down: { score: 4, emoji: "ğŸŒ™" } },
  "The Sun": { up: { score: 10, emoji: "â˜€ï¸" }, down: { score: 6, emoji: "â˜€ï¸" } },
  "ì‹¬íŒ": { up: { score: 9, emoji: "ğŸ“£" }, down: { score: 5, emoji: "ğŸ“£" } },
  "The World": { up: { score: 10, emoji: "ğŸŒ" }, down: { score: 6, emoji: "ğŸŒ" } }
};

const rareCombosSimple = {
  ["The Moon|The Star|The Sun".split("|").sort().join("|")]: "ë°¤ê³¼ ë‚®ì˜ ê²½ê³„ì—ì„œ ê¸°íšŒê°€ í”¼ì–´ë‚©ë‹ˆë‹¤ ğŸŒŸğŸŒ™â˜€ï¸ (ë ˆì–´)",
  ["The Moon|ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´|ì—¬ì‚¬ì œ".split("|").sort().join("|")]: "ì§ê´€ê³¼ íë¦„ì„ ë¯¿ìœ¼ì„¸ìš”. ê°ì¶°ì§„ ê¸°íšŒê°€ ë³´ì¼ì§€ë„ ğŸŒ™ğŸ¡ğŸ‘ï¸ (ë ˆì–´)",
  ["The Star|êµí™©|ì ˆì œ".split("|").sort().join("|")]: "ì˜ì ì¸ ì¹˜ìœ ì™€ ì¡°í™”ì˜ ê¸°ìš´ì´ ê°€ë“í•œ í•˜ë£¨ì…ë‹ˆë‹¤ ğŸ™ğŸŒˆâœ¨ (ë ˆì–´)",
  ["The Star|ì‹¬íŒ|ì€ë‘”ì,ì°ë”°".split("|").sort().join("|")]: "ìŒ“ì€ ë…¸ë ¥, ë“œë””ì–´ ë¹›ì„ ë³¼ ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤ âœ¨ğŸ§˜ğŸ“£ (ë ˆì–´)",
  ["The Star|ì—¬ì‚¬ì œ|ì—°ì¸".split("|").sort().join("|")]: "ì´ìƒê³¼ ì‚¬ë‘ì˜ í•˜ëª¨ë‹ˆ! ì„¤ë ˜ ê°€ë“í•œ í•˜ë£¨ ğŸ’˜âœ¨ğŸ‘¸ (ë ˆì–´)",
  ["The Sun|The World|ì—°ì¸".split("|").sort().join("|")]: "ì™„ë²½í•œ ì‚¬ë‘ê³¼ ì„±ê³µ! ì˜¤ëŠ˜ì€ ìš°ì£¼ì˜ ì¶•ë³µì´ í•¨ê»˜í•©ë‹ˆë‹¤ ğŸ’–ğŸŒğŸŒ (ë ˆì–´)",
  ["The Sun|ì „ì°¨|ì •ì˜".split("|").sort().join("|")]: "ì •ì˜ë¡œìš´ ëŒì§„! ì˜¤ëŠ˜ì€ ë‚´ê°€ ë²•ì´ë‹¤ ğŸï¸â˜€ï¸âš–ï¸ (ë ˆì–´)",
  ["The Tower|ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´|ì „ì°¨".split("|").sort().join("|")]: "ë©ˆì¶œ ìˆ˜ ì—†ëŠ” ë³€í™”ì˜ ì§ˆì£¼! ìƒˆíŒ ì§œê¸° ì‹œì‘! ğŸ¡ğŸï¸ğŸ’€ (ë ˆì–´)",
  ["The Tower|ì „ì°¨|í˜,ê¸°ë°±".split("|").sort().join("|")]: "ê°•í•œ ì¶”ì§„ë ¥ë„ í•„ìš”í•˜ì§€ë§Œ ì¡°ì‹¬! ì†ë„ ì¡°ì ˆ! ğŸï¸ğŸ’¥ğŸ’ª (ë ˆì–´)",
  ["The Tower|ë¹¡í†µ|ì „ì°¨".split("|").sort().join("|")]: "ì•„ì°”í•œ ì§ˆì£¼, ì •ì‹ ì¤„ ì¡°ì‹¬! ì˜¤ëŠ˜ì€ ì‚¬ê³ ë°©ì§€ë°ì´ ğŸ¤¡ğŸï¸ğŸ˜ˆ (ë ˆì–´)",
  ["The Tower|ì•…ë§ˆ|ì£½ìŒ".split("|").sort().join("|")]: "ì‹¬ìƒì¹˜ ì•Šì€ ì¡°í•©ì…ë‹ˆë‹¤. ë‚´ë©´ì„ ë‹¨ë‹¨íˆ ë‹¤ì¡ìœ¼ì„¸ìš”. (ë ˆì–´)",
  ["êµí™©|ë§ˆë²•ì‚¬|í™©ì œ".split("|").sort().join("|")]: "ì§€í˜œì™€ ê¶Œë ¥ì´ í•œ ìë¦¬ì—! ë¦¬ë”ì‹­ì´ ë¹›ë‚  ë‚ ì…ë‹ˆë‹¤ ğŸ‘‘ğŸ“˜ğŸ§™ (ë ˆì–´)",
  ["êµí™©|ì—¬ì‚¬ì œ|í™©ì œ".split("|").sort().join("|")]: "ì§€ì‹, ì‹ ë…, ê¶Œë ¥ì´ ë§Œë‚¬ìŠµë‹ˆë‹¤. ëˆ„ê°€ ê°íˆ ë„˜ë³´ë´ ğŸ™‡ğŸ“˜ğŸ‘‘ (ë ˆì–´)",
  ["ë§ˆë²•ì‚¬|ì‹¬íŒ|ì£½ìŒ".split("|").sort().join("|")]: "ë³€í™”ì˜ ë§ˆë²•ì´ ì‹œì‘ë©ë‹ˆë‹¤. ìš´ëª…ì˜ ì‹¬íŒì„ ë°›ì•„ë¼! ğŸ§™ğŸ’€ğŸ“£ (ë ˆì–´)",
  ["ë§¤ë‹¬ë¦°ì‚¬ëŒ|ë¹¡í†µ|ì€ë‘”ì,ì°ë”°".split("|").sort().join("|")]: "í˜¼ìë§Œì˜ ì„¸ê³„ì— ë¹ ì§ˆ ìˆ˜ ìˆì–´ìš”. ì¡°ìš©í•œ í•˜ë£¨ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤. (ë ˆì–´)",
  ["ì—¬ì‚¬ì œ|ì—°ì¸|ì ˆì œ".split("|").sort().join("|")]: "ì‚¬ë‘ê³¼ ì¡°í™”ì˜ ì—ë„ˆì§€! ì¸ê°„ê´€ê³„ê°€ ìˆ ìˆ  í’€ë¦´ ê±°ì˜ˆìš” ğŸ’•ğŸ¤ğŸŒˆ (ë ˆì–´)",
  ["ì—¬í™©ì œ|ì—°ì¸|í™©ì œ".split("|").sort().join("|")]: "ì´ë³´ë‹¤ ì™„ë²½í•œ ë°¸ëŸ°ìŠ¤ëŠ” ì—†ë‹¤! ğŸ’‘ğŸ‘‘ (ë ˆì–´)",
  ["ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´|ì‹¬íŒ|ì •ì˜".split("|").sort().join("|")]: "ìš´ëª…ê³¼ ì •ì˜, ê·¸ë¦¬ê³  ì‹¬íŒ! ë³€í™”ì˜ ì¤‘ì‹¬ì— ìˆìŠµë‹ˆë‹¤ âš–ï¸ğŸŒ€ğŸ“£ (ë ˆì–´)",
  ["ì€ë‘”ì,ì°ë”°|The Moon|ì•…ë§ˆ".split("|").sort().join("|")]: "ë‚´ë©´ì˜ ì–´ë‘ ì„ ì§ë©´í•˜ì„¸ìš”. í”¼í•˜ì§€ ë§ê³  ë§ˆì£¼ë³´ëŠ” ë‚  ğŸ§˜ğŸŒ™ğŸ˜ˆ (ë ˆì–´)",
  ["ì •ì˜|ì£½ìŒ|ì•…ë§ˆ".split("|").sort().join("|")]: "ì–´ë‘  ì†ì—ì„œë„ ê· í˜•ì„ ì°¾ëŠ” ìë§Œì´ ë³€í™”ë¥¼ ì´ëˆë‹¤ ğŸ˜ˆğŸ’€âš–ï¸ (ë ˆì–´)"
};


let bundles = { A: [], B: [], C: [] };
let selectedSet = null;
let revealed = false;

function drawThreeCards() {
  const names = Object.keys(tarotDeck);
  const used = new Set();
  const result = [];

  while (result.length < 3) {
    const name = names[Math.floor(Math.random() * names.length)];
    if (!used.has(name)) {
      used.add(name);
      const orientation = Math.random() > 0.5 ? "up" : "down";
      result.push({ name, orientation });
    }
  }

  return result;
}

function prepareDeck() {
  bundles.A = drawThreeCards();
  bundles.B = drawThreeCards();
  bundles.C = drawThreeCards();
}

function chooseCard(choice) {
  if (revealed) return;
  revealed = true;
  selectedSet = bundles[choice];
  document.querySelectorAll("#buttonArea button").forEach(btn => btn.disabled = true);

  let upCount = 0;
  let downCount = 0;

  const totalScore = selectedSet.reduce((sum, card) => {
    const info = tarotDeck[card.name]?.[card.orientation];
    if (!info) return sum;
    if (card.orientation === "up") upCount++;
    else downCount++;
    return sum + info.score;
  }, 0);

  const currentComboKey = selectedSet.map(c => c.name).sort().join("|");
  let comboMessage = rareCombosSimple[currentComboKey] || "";

  if (!comboMessage) {
    if (upCount === 3) comboMessage = "ì •ë°©í–¥ 3ì¥! ìš´ì´ ê°•í•˜ê²Œ ë”°ë¼ë¶™ìŠµë‹ˆë‹¤ ğŸ¯";
    else if (downCount === 3) comboMessage = "ëª¨ë‘ ì—­ë°©í–¥... ì˜ˆìƒê³¼ ë‹¤ë¥¸ íë¦„ì´ì—ìš” âš ï¸";
    else if (upCount === 2) comboMessage = "ì •ë°©í–¥ 2ì¥ ğŸ˜Š ìš´ì´ íŠ¸ì´ê¸° ì‹œì‘í–ˆì–´ìš”!";
    else if (downCount === 2) comboMessage = "ì—­ë°©í–¥ 2ì¥. ì‹ ì¤‘í•œ í•˜ë£¨ê°€ ë  ìˆ˜ë„ ìˆì–´ìš”!";
    else comboMessage = "";
  }

  let resultHTML = `<h3>ğŸ”® ${choice} ì„ íƒ ê²°ê³¼</h3>`;
  selectedSet.forEach(card => {
    const info = tarotDeck[card.name]?.[card.orientation];
    if (!info) return;
    const arrow = card.orientation === "up" ? "â¬†ï¸" : "â¬‡ï¸";
    const direction = card.orientation === "up" ? "ì •ë°©í–¥" : "ì—­ë°©í–¥";
    resultHTML += `
      <div class="card">${info.emoji} ${card.name} ${arrow} (${direction})<br>
      ì ìˆ˜: ${info.score}ì </div>`;
  });

  if (comboMessage) {
    resultHTML += `<p><strong>${comboMessage}</strong></p>`;
  }

  const ratingText = totalScore === 30 ? "ì´í•©: 30ì  (ë§Œì !)" :
    totalScore <= 10 ? `ì´í•©: ${totalScore}ì  (ìš´ë³´ì†Œ ã…‹ã…‹ã…‹)` :
    `ì´í•©: ${totalScore}ì  (ìƒìœ„ ${Math.round((totalScore / 30) * 100)}%)`;

  resultHTML += `<p><strong>${ratingText}</strong></p>`;
  document.getElementById("resultArea").innerHTML = resultHTML;

  let summaryHTML = `<h3>ğŸ“Š ë‹¤ë¥¸ ì„ íƒì§€ ì ìˆ˜ ìš”ì•½</h3>`;
  ["A", "B", "C"].forEach(label => {
    if (label === choice) return;
    const score = bundles[label].reduce((sum, c) => {
      const info = tarotDeck[c.name]?.[c.orientation];
      return sum + (info?.score || 0);
    }, 0);
    const percent = Math.round((score / 30) * 100);
    summaryHTML += `<p>ğŸ”¸ ${label} ì¹´ë“œ: ${score}ì  (${percent}%)</p>`;
  });

  document.getElementById("summary").innerHTML = summaryHTML;
  document.getElementById("buttonArea").style.display = "none";
}

function shareResult() {
  if (!selectedSet) return alert("ì¹´ë“œë¥¼ ë¨¼ì € ì„ íƒí•´ ì£¼ì„¸ìš”!");
  const shareText = selectedSet.map(card => {
    const info = tarotDeck[card.name][card.orientation];
    const arrow = card.orientation === "up" ? "â¬†ï¸" : "â¬‡ï¸";
    return `${info.emoji} ${card.name} ${arrow}`;
  }).join(", ");
  const totalScore = selectedSet.reduce(
    (sum, c) => sum + tarotDeck[c.name][c.orientation].score,
    0
  );
  const fullText = `ğŸ”® ìš´ë¹¨ë°°í‹€íƒ€ë¡œ ê²°ê³¼!\n[${shareText}]\nì´ì : ${totalScore}ì \nğŸ‘‰ https://jeffersonwattson.github.io/tarot-ai/`;

  if (navigator.share) {
    navigator.share({ title: "ìš´ë¹¨ë°°í‹€íƒ€ë¡œ", text: fullText, url: window.location.href });
  } else {
    navigator.clipboard.writeText(fullText).then(() => alert("ê²°ê³¼ ë³µì‚¬ë¨ ğŸ“‹"));
  }
}

window.onload = prepareDeck;
</script>
</body>
</html>
